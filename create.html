<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إنشاء بوستر - PostMaker AI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/create.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="js/arabic-reshaper.js"></script>
</head>
<body class="create-page">
    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
    </div>

    <!-- Main Create Section -->
    <main class="create-main create-main-fullscreen">
        <!-- Back to Home Button -->
        <a href="index.html" class="back-home-btn">
            <i class="fas fa-home"></i>
            <span>الرئيسية</span>
        </a>
        
        <div class="container">
            <div class="create-wrapper">
                <!-- Main Form Card -->
                <div class="form-section">
                    <!-- Progress Bar -->
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>

                    <div class="form-content">
                        <!-- Step 1: Category Selection -->
                        <div class="form-step active" id="step1">
                        <div class="step-header">
                            <span class="step-indicator">الخطوة 1 من 3</span>
                            <h2>اختر نوع نشاطك</h2>
                            <p>حدد المجال لنقدم لك أفضل القوالب</p>
                        </div>

                        <div class="category-selection">
                            <label class="category-option">
                                <input type="radio" name="category" value="restaurant">
                                <div class="option-content">
                                    <div class="option-icon"><i class="fas fa-utensils"></i></div>
                                    <div class="option-info">
                                        <h4>مطاعم وكافيهات</h4>
                                        <span>15 قالب</span>
                                    </div>
                                </div>
                            </label>

                            <label class="category-option">
                                <input type="radio" name="category" value="supermarket">
                                <div class="option-content">
                                    <div class="option-icon"><i class="fas fa-shopping-cart"></i></div>
                                    <div class="option-info">
                                        <h4>سوبر ماركت</h4>
                                        <span>12 قالب</span>
                                    </div>
                                </div>
                            </label>

                            <label class="category-option">
                                <input type="radio" name="category" value="online">
                                <div class="option-content">
                                    <div class="option-icon"><i class="fas fa-store"></i></div>
                                    <div class="option-info">
                                        <h4>متاجر إلكترونية</h4>
                                        <span>10 قوالب</span>
                                    </div>
                                </div>
                            </label>

                            <label class="category-option">
                                <input type="radio" name="category" value="services">
                                <div class="option-content">
                                    <div class="option-icon"><i class="fas fa-briefcase"></i></div>
                                    <div class="option-info">
                                        <h4>خدمات</h4>
                                        <span>8 قوالب</span>
                                    </div>
                                </div>
                            </label>

                            <label class="category-option">
                                <input type="radio" name="category" value="fashion">
                                <div class="option-content">
                                    <div class="option-icon"><i class="fas fa-shirt"></i></div>
                                    <div class="option-info">
                                        <h4>أزياء وموضة</h4>
                                        <span>10 قوالب</span>
                                    </div>
                                </div>
                            </label>

                            <label class="category-option">
                                <input type="radio" name="category" value="beauty">
                                <div class="option-content">
                                    <div class="option-icon"><i class="fas fa-spa"></i></div>
                                    <div class="option-info">
                                        <h4>تجميل وعناية</h4>
                                        <span>8 قوالب</span>
                                    </div>
                                </div>
                            </label>
                        </div>

                        <div class="step-actions">
                            <button type="button" class="btn btn-primary btn-lg btn-next" data-next="2" disabled>
                                التالي
                                <i class="fas fa-arrow-left"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: Template Selection -->
                    <div class="form-step" id="step2">
                        <div class="step-header">
                            <span class="step-indicator">الخطوة 2 من 4</span>
                            <h2>اختر طريقة التصميم</h2>
                            <p>استخدم الذكاء الاصطناعي أو اختر قالب جاهز</p>
                        </div>

                        <!-- AI Mode Toggle -->
                        <div class="ai-mode-toggle">
                            <button type="button" class="mode-btn active" id="aiModeBtn" data-mode="ai">
                                <div class="mode-icon">
                                    <i class="fas fa-magic"></i>
                                    <span class="ai-badge">AI</span>
                                </div>
                                <div class="mode-info">
                                    <h4>تصميم بالذكاء الاصطناعي</h4>
                                    <p>خلفيات فريدة مولدة بـ Stable Diffusion</p>
                                </div>
                            </button>
                            <button type="button" class="mode-btn" id="templateModeBtn" data-mode="template">
                                <div class="mode-icon">
                                    <i class="fas fa-th-large"></i>
                                </div>
                                <div class="mode-info">
                                    <h4>قوالب جاهزة</h4>
                                    <p>اختر من مكتبة القوالب المصممة</p>
                                </div>
                            </button>
                        </div>

                        <!-- AI Style Selection (shown when AI mode) -->
                        <div class="ai-style-section" id="aiStyleSection">
                            <h4 class="section-title"><i class="fas fa-wand-magic-sparkles"></i> اختر نمط التصميم</h4>
                            <div class="ai-styles-grid">
                                <label class="ai-style-option active" data-style="modern">
                                    <input type="radio" name="aiStyle" value="modern" checked>
                                    <div class="style-card">
                                        <div class="style-icon"><i class="fas fa-bolt"></i></div>
                                        <h5>عصري</h5>
                                        <p>تصميم حديث وأنيق</p>
                                    </div>
                                </label>
                                <label class="ai-style-option" data-style="classic">
                                    <input type="radio" name="aiStyle" value="classic">
                                    <div class="style-card">
                                        <div class="style-icon"><i class="fas fa-crown"></i></div>
                                        <h5>كلاسيكي</h5>
                                        <p>تصميم تقليدي راقي</p>
                                    </div>
                                </label>
                                <label class="ai-style-option" data-style="luxury">
                                    <input type="radio" name="aiStyle" value="luxury">
                                    <div class="style-card">
                                        <div class="style-icon"><i class="fas fa-gem"></i></div>
                                        <h5>فاخر</h5>
                                        <p>تصميم فخم وراقي</p>
                                    </div>
                                </label>
                                <label class="ai-style-option" data-style="colorful">
                                    <input type="radio" name="aiStyle" value="colorful">
                                    <div class="style-card">
                                        <div class="style-icon"><i class="fas fa-palette"></i></div>
                                        <h5>ملوّن</h5>
                                        <p>تصميم مشرق وحيوي</p>
                                    </div>
                                </label>
                                <label class="ai-style-option" data-style="minimal">
                                    <input type="radio" name="aiStyle" value="minimal">
                                    <div class="style-card">
                                        <div class="style-icon"><i class="fas fa-minus-circle"></i></div>
                                        <h5>بسيط</h5>
                                        <p>تصميم نظيف ومبسط</p>
                                    </div>
                                </label>
                            </div>
                            
                            <div class="ai-custom-prompt">
                                <label><i class="fas fa-pencil-alt"></i> وصف إضافي (اختياري)</label>
                                <input type="text" id="aiCustomPrompt" placeholder="مثال: خلفية دافئة مع إضاءة ذهبية..." dir="rtl">
                                <small>اكتب وصف بالعربي أو الإنجليزي لتخصيص الخلفية</small>
                            </div>
                        </div>

                        <!-- Templates Grid (shown when Template mode) -->
                        <div id="templatesContainer" class="templates-grid" style="display: none;">
                            <div class="loading-templates-step">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>جاري تحميل القوالب...</p>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button type="button" class="btn btn-outline btn-lg" data-prev="1">
                                <i class="fas fa-arrow-right"></i>
                                السابق
                            </button>
                            <button type="button" class="btn btn-primary btn-lg btn-next" data-next="3" disabled>
                                التالي
                                <i class="fas fa-arrow-left"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Data Entry -->
                    <div class="form-step" id="step3">
                        <div class="step-header">
                            <span class="step-indicator">الخطوة 3 من 4</span>
                            <h2>أدخل بيانات العرض</h2>
                            <p>املأ المعلومات ليقوم الذكاء الاصطناعي بالتصميم</p>
                        </div>

                        <form id="posterDataForm">
                            <div class="form-grid">
                                <div class="form-group full-width">
                                    <label>
                                        <i class="fas fa-store"></i>
                                        اسم النشاط / المحل
                                    </label>
                                    <input type="text" id="businessName" placeholder="مثال: مطعم الشيف الذهبي" required>
                                </div>

                                <div class="form-group full-width">
                                    <label>
                                        <i class="fas fa-tag"></i>
                                        اسم المنتج / الخدمة
                                    </label>
                                    <input type="text" id="productName" placeholder="مثال: برجر لحم أنجوس">
                                </div>

                                <div class="form-group">
                                    <label>
                                        <i class="fas fa-dollar-sign"></i>
                                        السعر الأصلي (اختياري)
                                    </label>
                                    <input type="text" id="originalPrice" placeholder="50 ريال">
                                </div>

                                <div class="form-group">
                                    <label>
                                        <i class="fas fa-fire"></i>
                                        سعر العرض
                                    </label>
                                    <input type="text" id="offerPrice" placeholder="35 ريال" required>
                                </div>

                                <div class="form-group full-width">
                                    <label>
                                        <i class="fas fa-bullhorn"></i>
                                        نص العرض
                                    </label>
                                    <select id="offerText">
                                        <option value="عرض لفترة محدودة">عرض لفترة محدودة</option>
                                        <option value="وفر في مشترياتك">وفر في مشترياتك</option>
                                        <option value="خصم خاص">خصم خاص</option>
                                        <option value="عرض حصري">عرض حصري</option>
                                        <option value="اشتري الآن">اشتري الآن</option>
                                    </select>
                                </div>

                                <div class="form-group full-width">
                                    <label>
                                        <i class="fab fa-whatsapp"></i>
                                        رقم الواتساب
                                    </label>
                                    <input type="tel" id="whatsapp" placeholder="+966xxxxxxxxxx" dir="ltr">
                                </div>

                                <div class="form-group full-width">
                                    <label>
                                        <i class="fas fa-image"></i>
                                        صورة المنتج (اختياري)
                                    </label>
                                    <div class="upload-zone" id="uploadZone">
                                        <input type="file" id="productImage" accept="image/*">
                                        <div class="upload-icon">
                                            <i class="fas fa-cloud-upload-alt"></i>
                                        </div>
                                        <h4>اضغط لرفع صورة</h4>
                                        <p>أو اسحب الملف هنا</p>
                                        <small>PNG, JPG, WEBP - حتى 5MB</small>
                                    </div>
                                    <div class="image-preview" id="imagePreview">
                                        <img id="previewImg" src="" alt="Preview">
                                        <button type="button" class="remove-image" id="removeImage">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>

                        <div class="step-actions">
                            <button type="button" class="btn btn-outline btn-lg" data-prev="2">
                                <i class="fas fa-arrow-right"></i>
                                السابق
                            </button>
                            <button type="button" class="btn btn-primary btn-lg btn-next" data-next="4">
                                التالي
                                <i class="fas fa-arrow-left"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 4: Customization -->
                    <div class="form-step" id="step4">
                        <div class="step-header">
                            <span class="step-indicator">الخطوة 4 من 4</span>
                            <h2>خصص التصميم</h2>
                            <p>اختر الألوان والحجم المناسب</p>
                        </div>

                        <!-- Customization Layout with Preview -->
                        <div class="customization-layout">
                            <!-- Left Side: Canvas Preview -->
                            <div class="customize-preview-panel">
                                <div class="preview-sticky">
                                    <div class="preview-header-mini">
                                        <h3>معاينة مباشرة</h3>
                                        <span class="preview-badge-mini">
                                            <i class="fas fa-eye"></i>
                                            تحديث تلقائي
                                        </span>
                                    </div>
                                    <div class="preview-canvas-container">
                                        <canvas id="posterCanvas"></canvas>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Side: Customization Options -->
                            <div class="customize-options-wrapper">
                                <div class="customize-options">
                                    <!-- Template Info -->
                                    <div class="option-group" id="templateInfoBox" style="display: none;">
                                        <label class="group-label">
                                            <i class="fas fa-layer-group"></i>
                                            القالب المستخدم
                                        </label>
                                        <div class="template-info-display">
                                            <img id="selectedTemplateThumb" src="" alt="" style="width: 80px; height: 80px; object-fit: cover; border-radius: 12px; margin-left: 15px;">
                                            <div style="flex: 1;">
                                                <h4 id="selectedTemplateName" style="font-size: 16px; margin: 0 0 5px 0;"></h4>
                                                <p id="selectedTemplateDesc" style="font-size: 13px; color: #6B7280; margin: 0;"></p>
                                            </div>
                                    <button type="button" class="btn btn-outline btn-sm" onclick="changeTemplate()">
                                        <i class="fas fa-exchange-alt"></i>
                                        تغيير
                                    </button>
                                </div>
                            </div>

                            <!-- Layout Controls -->
                            <div class="option-group">
                                <label class="group-label">
                                    <i class="fas fa-sliders-h"></i>
                                    تخصيص التخطيط
                                </label>
                                <div class="layout-controls">
                                    <div class="control-item">
                                        <label>موضع العنوان (Y)</label>
                                        <input type="range" id="titlePositionY" min="0.05" max="0.3" value="0.15" step="0.01">
                                        <span class="value-display" id="titlePositionYValue">15%</span>
                                    </div>
                                    <div class="control-item">
                                        <label>موضع العنوان (X)</label>
                                        <input type="range" id="titlePositionX" min="0.1" max="0.9" value="0.5" step="0.01">
                                        <span class="value-display" id="titlePositionXValue">50%</span>
                                    </div>
                                    <div class="control-item">
                                        <label>حجم العنوان</label>
                                        <input type="range" id="titleSize" min="30" max="80" value="56" step="2">
                                        <span class="value-display" id="titleSizeValue">56px</span>
                                    </div>
                                    <div class="control-item">
                                        <label>موضع الصورة (Y)</label>
                                        <input type="range" id="imagePositionY" min="0.25" max="0.65" value="0.48" step="0.01">
                                        <span class="value-display" id="imagePositionYValue">48%</span>
                                    </div>
                                    <div class="control-item">
                                        <label>موضع الصورة (X)</label>
                                        <input type="range" id="imagePositionX" min="0.1" max="0.9" value="0.5" step="0.01">
                                        <span class="value-display" id="imagePositionXValue">50%</span>
                                    </div>
                                    <div class="control-item">
                                        <label>حجم الصورة</label>
                                        <input type="range" id="imageScale" min="0.2" max="0.6" value="0.38" step="0.02">
                                        <span class="value-display" id="imageScaleValue">38%</span>
                                    </div>
                                    <div class="control-item">
                                        <label>موضع السعر (Y)</label>
                                        <input type="range" id="pricePositionY" min="0.5" max="0.85" value="0.72" step="0.01">
                                        <span class="value-display" id="pricePositionYValue">72%</span>
                                    </div>
                                    <div class="control-item">
                                        <label>موضع السعر (X)</label>
                                        <input type="range" id="pricePositionX" min="0.1" max="0.9" value="0.5" step="0.01">
                                        <span class="value-display" id="pricePositionXValue">50%</span>
                                    </div>
                                    <div class="control-item">
                                        <label>حجم السعر</label>
                                        <input type="range" id="priceSize" min="40" max="70" value="52" step="2">
                                        <span class="value-display" id="priceSizeValue">52px</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Size Selection -->
                            <div class="option-group">
                                <label class="group-label">
                                    <i class="fas fa-expand"></i>
                                    حجم البوستر
                                </label>
                                <div class="size-options">
                                    <label class="size-option">
                                        <input type="radio" name="size" value="instagram-post" checked>
                                        <div class="size-preview square">
                                            <i class="fab fa-instagram"></i>
                                        </div>
                                        <span>انستقرام بوست</span>
                                        <small>1080x1080</small>
                                    </label>
                                    <label class="size-option">
                                        <input type="radio" name="size" value="instagram-story">
                                        <div class="size-preview story">
                                            <i class="fab fa-instagram"></i>
                                        </div>
                                        <span>انستقرام ستوري</span>
                                        <small>1080x1920</small>
                                    </label>
                                    <label class="size-option">
                                        <input type="radio" name="size" value="facebook-post">
                                        <div class="size-preview facebook">
                                            <i class="fab fa-facebook"></i>
                                        </div>
                                        <span>فيسبوك بوست</span>
                                        <small>1200x630</small>
                                    </label>
                                    <label class="size-option">
                                        <input type="radio" name="size" value="twitter-post">
                                        <div class="size-preview twitter">
                                            <i class="fab fa-twitter"></i>
                                        </div>
                                        <span>تويتر بوست</span>
                                        <small>1200x675</small>
                                    </label>
                                </div>
                            </div>

                            <!-- Color Selection -->
                            <div class="option-group">
                                <label class="group-label">
                                    <i class="fas fa-palette"></i>
                                    اللون الرئيسي
                                </label>
                                <div class="color-options">
                                    <label class="color-option">
                                        <input type="radio" name="color" value="#8B5CF6" checked>
                                        <span class="color-swatch" style="background: #8B5CF6"></span>
                                    </label>
                                    <label class="color-option">
                                        <input type="radio" name="color" value="#EF4444">
                                        <span class="color-swatch" style="background: #EF4444"></span>
                                    </label>
                                    <label class="color-option">
                                        <input type="radio" name="color" value="#F59E0B">
                                        <span class="color-swatch" style="background: #F59E0B"></span>
                                    </label>
                                    <label class="color-option">
                                        <input type="radio" name="color" value="#10B981">
                                        <span class="color-swatch" style="background: #10B981"></span>
                                    </label>
                                    <label class="color-option">
                                        <input type="radio" name="color" value="#3B82F6">
                                        <span class="color-swatch" style="background: #3B82F6"></span>
                                    </label>
                                    <label class="color-option">
                                        <input type="radio" name="color" value="#EC4899">
                                        <span class="color-swatch" style="background: #EC4899"></span>
                                    </label>
                                    <label class="color-option">
                                        <input type="radio" name="color" value="#1F2937">
                                        <span class="color-swatch" style="background: #1F2937"></span>
                                    </label>
                                    <label class="color-option custom">
                                        <input type="color" name="customColor" id="customColor" value="#8B5CF6">
                                        <span class="color-swatch custom-swatch">
                                            <i class="fas fa-plus"></i>
                                        </span>
                                    </label>
                                </div>
                            </div>

                            <!-- CTA Text -->
                            <div class="option-group">
                                <label class="group-label">
                                    <i class="fas fa-hand-pointer"></i>
                                    نص الزر
                                </label>
                                <select id="ctaText" class="styled-select">
                                    <option value="اطلب الآن">اطلب الآن</option>
                                    <option value="تواصل معنا">تواصل معنا</option>
                                    <option value="احجز الآن">احجز الآن</option>
                                    <option value="اشتري الآن">اشتري الآن</option>
                                    <option value="زورنا">زورنا</option>
                                </select>
                            </div>
                                </div>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button type="button" class="btn btn-ghost btn-back" data-back="2">
                                <i class="fas fa-arrow-right"></i>
                                السابق
                            </button>
                            <button type="button" class="btn btn-primary btn-lg btn-generate" id="generateBtn">
                                <i class="fas fa-wand-magic-sparkles"></i>
                                إنشاء البوستر
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Templates Selection (shown after step 2) -->
                <div class="templates-bar" id="templatesBar">
                    <h4>اختر القالب</h4>
                    <div class="templates-scroll" id="templatesScroll">
                        <!-- Templates will be loaded dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- AI Processing Modal -->
    <div class="modal-overlay" id="aiModal">
        <div class="ai-modal">
            <div class="ai-modal-content">
                <div class="ai-animation">
                    <div class="ai-circle">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="ai-waves">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
                
                <h3 id="aiTitle">الذكاء الاصطناعي يعمل...</h3>
                
                <div class="ai-steps">
                    <div class="ai-step" id="step-analyze" data-step="analyze">
                        <div class="step-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <div class="step-info">
                            <span class="step-name">تحليل بيانات العرض</span>
                            <span class="step-desc">فهم تفاصيل المنتج والفئة</span>
                        </div>
                        <div class="step-status">
                            <i class="fas fa-circle-notch fa-spin waiting-icon"></i>
                            <i class="fas fa-check completed-icon" style="display:none"></i>
                        </div>
                    </div>
                    
                    <div class="ai-step" id="step-ai-generate" data-step="ai-generate">
                        <div class="step-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="step-info">
                            <span class="step-name">إنشاء خلفية بالذكاء الاصطناعي</span>
                            <span class="step-desc">Stable Diffusion XL يصمم الخلفية</span>
                        </div>
                        <div class="step-status">
                            <i class="fas fa-circle-notch fa-spin waiting-icon"></i>
                            <i class="fas fa-check completed-icon" style="display:none"></i>
                        </div>
                    </div>
                    
                    <div class="ai-step" id="step-load-bg" data-step="load-bg">
                        <div class="step-icon">
                            <i class="fas fa-image"></i>
                        </div>
                        <div class="step-info">
                            <span class="step-name">تحميل الخلفية على التصميم</span>
                            <span class="step-desc">تطبيق الخلفية المولدة</span>
                        </div>
                        <div class="step-status">
                            <i class="fas fa-circle-notch fa-spin waiting-icon"></i>
                            <i class="fas fa-check completed-icon" style="display:none"></i>
                        </div>
                    </div>
                    
                    <div class="ai-step" id="step-text" data-step="text">
                        <div class="step-icon">
                            <i class="fas fa-font"></i>
                        </div>
                        <div class="step-info">
                            <span class="step-name">إضافة النصوص العربية</span>
                            <span class="step-desc">كتابة العناوين والأسعار بالعربي</span>
                        </div>
                        <div class="step-status">
                            <i class="fas fa-circle-notch fa-spin waiting-icon"></i>
                            <i class="fas fa-check completed-icon" style="display:none"></i>
                        </div>
                    </div>
                    
                    <div class="ai-step" id="step-compose" data-step="compose">
                        <div class="step-icon">
                            <i class="fas fa-layer-group"></i>
                        </div>
                        <div class="step-info">
                            <span class="step-name">تنسيق البوستر النهائي</span>
                            <span class="step-desc">تجميع كل العناصر معاً</span>
                        </div>
                        <div class="step-status">
                            <i class="fas fa-circle-notch fa-spin waiting-icon"></i>
                            <i class="fas fa-check completed-icon" style="display:none"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Result Page (Full Width) -->
    <div class="result-page" id="resultPage" style="display: none;">
        <div class="result-page-header">
            <div class="container">
                <button class="btn btn-ghost" id="backToEditor">
                    <i class="fas fa-arrow-right"></i>
                    العودة للمحرر
                </button>
                <h2><i class="fas fa-check-circle"></i> تم إنشاء البوستر بنجاح!</h2>
                <p>يمكنك تحميل التصميم أو إنشاء تصميم جديد</p>
            </div>
        </div>
        
        <div class="result-page-body">
            <div class="result-page-grid">
                <!-- Preview Section -->
                <div class="result-page-preview">
                    <canvas id="resultCanvas"></canvas>
                </div>
                
                <!-- Actions Section -->
                <div class="result-page-actions">
                    <!-- Editor Card -->
                    <div class="action-card editor-card">
                        <h3 class="editor-section-toggle active" data-section="editText">
                            <i class="fas fa-edit"></i> تحرير النصوص
                            <i class="fas fa-chevron-down toggle-arrow"></i>
                        </h3>
                        <div class="editor-section" id="editTextSection">
                            <div class="editor-controls">
                                <div class="editor-field">
                                    <label>اسم النشاط</label>
                                    <input type="text" id="editBusinessName" class="edit-input" dir="rtl" placeholder="اسم النشاط">
                                </div>
                                <div class="editor-field">
                                    <label>اسم المنتج</label>
                                    <input type="text" id="editProductName" class="edit-input" dir="rtl" placeholder="اسم المنتج">
                                </div>
                                <div class="editor-field">
                                    <label>نص العرض</label>
                                    <input type="text" id="editOfferText" class="edit-input" dir="rtl" placeholder="عرض خاص">
                                </div>
                                <div class="editor-field-row">
                                    <div class="editor-field">
                                        <label>السعر الأصلي</label>
                                        <input type="text" id="editOriginalPrice" class="edit-input" placeholder="45">
                                    </div>
                                    <div class="editor-field">
                                        <label>سعر العرض</label>
                                        <input type="text" id="editOfferPrice" class="edit-input" placeholder="54">
                                    </div>
                                </div>
                                <div class="editor-field">
                                    <label>رقم واتساب</label>
                                    <input type="text" id="editWhatsapp" class="edit-input" placeholder="4356535">
                                </div>
                                <div class="editor-field">
                                    <label>نص الزر</label>
                                    <select id="editCtaText" class="edit-input">
                                        <option value="اطلب الآن">اطلب الآن</option>
                                        <option value="تواصل معنا">تواصل معنا</option>
                                        <option value="احجز الآن">احجز الآن</option>
                                        <option value="اشتري الآن">اشتري الآن</option>
                                        <option value="زورنا">زورنا</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Layout Controls Card -->
                    <div class="action-card editor-card">
                        <h3 class="editor-section-toggle" data-section="editLayout">
                            <i class="fas fa-sliders-h"></i> تخصيص التخطيط
                            <i class="fas fa-chevron-down toggle-arrow"></i>
                        </h3>
                        <div class="editor-section collapsed" id="editLayoutSection">
                            <div class="editor-controls">
                                <div class="editor-range">
                                    <label>موضع العنوان (Y)</label>
                                    <div class="range-row">
                                        <input type="range" id="editTitlePosY" min="0.05" max="0.3" value="0.15" step="0.01">
                                        <span class="range-val" id="editTitlePosYVal">15%</span>
                                    </div>
                                </div>
                                <div class="editor-range">
                                    <label>موضع العنوان (X)</label>
                                    <div class="range-row">
                                        <input type="range" id="editTitlePosX" min="0.1" max="0.9" value="0.5" step="0.01">
                                        <span class="range-val" id="editTitlePosXVal">50%</span>
                                    </div>
                                </div>
                                <div class="editor-range">
                                    <label>حجم العنوان</label>
                                    <div class="range-row">
                                        <input type="range" id="editTitleSize" min="30" max="80" value="56" step="2">
                                        <span class="range-val" id="editTitleSizeVal">56px</span>
                                    </div>
                                </div>
                                <div class="editor-range">
                                    <label>موضع الصورة (Y)</label>
                                    <div class="range-row">
                                        <input type="range" id="editImgPosY" min="0.2" max="0.65" value="0.48" step="0.01">
                                        <span class="range-val" id="editImgPosYVal">48%</span>
                                    </div>
                                </div>
                                <div class="editor-range">
                                    <label>موضع الصورة (X)</label>
                                    <div class="range-row">
                                        <input type="range" id="editImgPosX" min="0.1" max="0.9" value="0.5" step="0.01">
                                        <span class="range-val" id="editImgPosXVal">50%</span>
                                    </div>
                                </div>
                                <div class="editor-range">
                                    <label>حجم الصورة</label>
                                    <div class="range-row">
                                        <input type="range" id="editImgScale" min="0.2" max="0.6" value="0.38" step="0.02">
                                        <span class="range-val" id="editImgScaleVal">38%</span>
                                    </div>
                                </div>
                                <div class="editor-range">
                                    <label>موضع السعر (Y)</label>
                                    <div class="range-row">
                                        <input type="range" id="editPricePosY" min="0.5" max="0.85" value="0.72" step="0.01">
                                        <span class="range-val" id="editPricePosYVal">72%</span>
                                    </div>
                                </div>
                                <div class="editor-range">
                                    <label>موضع السعر (X)</label>
                                    <div class="range-row">
                                        <input type="range" id="editPricePosX" min="0.1" max="0.9" value="0.5" step="0.01">
                                        <span class="range-val" id="editPricePosXVal">50%</span>
                                    </div>
                                </div>
                                <div class="editor-range">
                                    <label>حجم السعر</label>
                                    <div class="range-row">
                                        <input type="range" id="editPriceSize" min="30" max="70" value="52" step="2">
                                        <span class="range-val" id="editPriceSizeVal">52px</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Size & Color Card -->
                    <div class="action-card editor-card">
                        <h3 class="editor-section-toggle" data-section="editStyle">
                            <i class="fas fa-palette"></i> الحجم واللون
                            <i class="fas fa-chevron-down toggle-arrow"></i>
                        </h3>
                        <div class="editor-section collapsed" id="editStyleSection">
                            <div class="editor-controls">
                                <div class="editor-field">
                                    <label>حجم البوستر</label>
                                    <div class="edit-size-grid">
                                        <label class="edit-size-option active">
                                            <input type="radio" name="editSize" value="instagram-post" checked>
                                            <i class="fab fa-instagram"></i>
                                            <span>انستقرام بوست</span>
                                            <small>1080×1080</small>
                                        </label>
                                        <label class="edit-size-option">
                                            <input type="radio" name="editSize" value="instagram-story">
                                            <i class="fab fa-instagram"></i>
                                            <span>انستقرام ستوري</span>
                                            <small>1080×1920</small>
                                        </label>
                                        <label class="edit-size-option">
                                            <input type="radio" name="editSize" value="facebook-post">
                                            <i class="fab fa-facebook"></i>
                                            <span>فيسبوك بوست</span>
                                            <small>1200×630</small>
                                        </label>
                                        <label class="edit-size-option">
                                            <input type="radio" name="editSize" value="twitter-post">
                                            <i class="fab fa-twitter"></i>
                                            <span>تويتر بوست</span>
                                            <small>1200×675</small>
                                        </label>
                                    </div>
                                </div>
                                <div class="editor-field">
                                    <label>اللون الرئيسي</label>
                                    <div class="edit-color-grid">
                                        <label class="edit-color-swatch" style="background: #8B5CF6" title="بنفسجي">
                                            <input type="radio" name="editColor" value="#8B5CF6" checked>
                                            <i class="fas fa-check"></i>
                                        </label>
                                        <label class="edit-color-swatch" style="background: #EF4444" title="أحمر">
                                            <input type="radio" name="editColor" value="#EF4444">
                                            <i class="fas fa-check"></i>
                                        </label>
                                        <label class="edit-color-swatch" style="background: #F59E0B" title="ذهبي">
                                            <input type="radio" name="editColor" value="#F59E0B">
                                            <i class="fas fa-check"></i>
                                        </label>
                                        <label class="edit-color-swatch" style="background: #10B981" title="أخضر">
                                            <input type="radio" name="editColor" value="#10B981">
                                            <i class="fas fa-check"></i>
                                        </label>
                                        <label class="edit-color-swatch" style="background: #3B82F6" title="أزرق">
                                            <input type="radio" name="editColor" value="#3B82F6">
                                            <i class="fas fa-check"></i>
                                        </label>
                                        <label class="edit-color-swatch" style="background: #EC4899" title="وردي">
                                            <input type="radio" name="editColor" value="#EC4899">
                                            <i class="fas fa-check"></i>
                                        </label>
                                        <label class="edit-color-swatch" style="background: #1F2937" title="داكن">
                                            <input type="radio" name="editColor" value="#1F2937">
                                            <i class="fas fa-check"></i>
                                        </label>
                                        <label class="edit-color-swatch custom-picker" title="لون مخصص">
                                            <input type="color" id="editCustomColor" value="#8B5CF6">
                                            <i class="fas fa-plus"></i>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Apply Button -->
                    <button class="btn btn-primary btn-lg btn-full editor-apply-btn" id="applyEditsBtn">
                        <i class="fas fa-sync-alt"></i>
                        تطبيق التعديلات
                    </button>

                    <div class="action-card">
                        <h3><i class="fas fa-download"></i> تحميل التصميم</h3>
                        <div class="action-buttons-stack">
                            <button class="btn btn-primary btn-lg btn-full" id="downloadBtn">
                                <i class="fas fa-download"></i>
                                تحميل PNG (جودة عالية)
                            </button>
                            <button class="btn btn-success btn-lg btn-full" id="exportAdvancedBtn">
                                <i class="fas fa-file-export"></i>
                                خيارات تصدير متقدمة
                            </button>
                        </div>
                        
                        <!-- Advanced Export Options -->
                        <div class="export-options" id="exportOptions" style="display: none;">
                            <h4><i class="fas fa-magic"></i> خيارات التصدير المتقدمة</h4>
                            
                            <div class="export-section">
                                <label>📐 حجم التصميم:</label>
                                <select id="exportPreset" class="form-select">
                                    <option value="instagram_post">Instagram Post (1080x1080)</option>
                                    <option value="instagram_story">Instagram Story (1080x1920)</option>
                                    <option value="facebook_post">Facebook Post (1200x630)</option>
                                    <option value="facebook_cover">Facebook Cover (820x312)</option>
                                    <option value="twitter_post">Twitter Post (1200x675)</option>
                                    <option value="linkedin_post">LinkedIn Post (1200x627)</option>
                                    <option value="pinterest_pin">Pinterest Pin (1000x1500)</option>
                                    <option value="youtube_thumbnail">YouTube Thumbnail (1280x720)</option>
                                    <option value="whatsapp_status">WhatsApp Status (1080x1920)</option>
                                    <option value="a4_portrait">A4 Portrait للطباعة</option>
                                    <option value="a4_landscape">A4 Landscape للطباعة</option>
                                </select>
                            </div>
                            
                            <div class="export-section">
                                <label>🎨 صيغة الملف:</label>
                                <select id="exportFormat" class="form-select">
                                    <option value="png">PNG (أعلى جودة)</option>
                                    <option value="jpg">JPG (حجم أصغر)</option>
                                    <option value="webp">WebP (للويب)</option>
                                </select>
                            </div>
                            
                            <div class="export-section">
                                <button class="btn btn-primary btn-full" id="executeExport">
                                    <i class="fas fa-download"></i>
                                    تحميل بالإعدادات المحددة
                                </button>
                                <button class="btn btn-outline btn-full" id="batchExport" style="margin-top: 0.5rem;">
                                    <i class="fas fa-layer-group"></i>
                                    تحميل جميع المقاسات
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-card">
                        <h3><i class="fas fa-redo"></i> خيارات أخرى</h3>
                        <div class="action-buttons-stack">
                            <button class="btn btn-outline btn-lg btn-full" id="newDesignBtn">
                                <i class="fas fa-plus"></i>
                                تصميم جديد
                            </button>
                            <button class="btn btn-ghost btn-full" id="tryAnotherBtn">
                                <i class="fas fa-sync-alt"></i>
                                جرب قالب آخر
                            </button>
                        </div>
                    </div>
                    
                    <div class="action-card">
                        <h3><i class="fas fa-history"></i> الحفظ والسجل</h3>
                        <div class="action-buttons-stack">
                            <button class="btn btn-ghost btn-full" id="saveDesignBtn">
                                <i class="fas fa-save"></i>
                                حفظ التصميم
                            </button>
                            <button class="btn btn-ghost btn-full" id="showHistoryBtn">
                                <i class="fas fa-history"></i>
                                التصاميم السابقة
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/api-service.js"></script>
    <script src="js/templates.js"></script>
    <script src="js/professional-features.js"></script>
    <script src="js/generator.js"></script>
    <script src="js/ai-hybrid-generator.js"></script>
    <script src="js/create.js"></script>
</body>
</html>
